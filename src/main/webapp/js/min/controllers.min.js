var cascadiaControllers=angular.module("cascadiaControllers",["base64"]);cascadiaControllers.controller("EngineerController",["$scope","GrowlResponse",function(e){function t(t){t.selected===!0&&t.disabled!==!0&&(e.selectedEngineers.push({number:t.number,name:t.name,paygrade:t.paygrade,selected:!1}),t.disabled=!0,t.selected=!1)}function n(t){if(void 0!==t&&t.selected===!0){for(var n=t.number,o=0;o<e.engineers.length;o++)e.engineers[o].number==n&&(e.engineers[o].disabled=!1);var r=e.selectedEngineers.indexOf(t);return r>-1&&e.selectedEngineers.splice(r,1),!0}return!1}e.engineers=[{number:"A1111",name:"Javier Olson",paygrade:"P4",selected:!1,disabled:!1},{number:"A1112",name:"Nancy Garcia",paygrade:"P5",selected:!1,disabled:!1},{number:"A1113",name:"David Bowden",paygrade:"SS",selected:!1,disabled:!1}],e.selectedEngineers=[],e.selectE=function(t){e.engineers[t].disabled||(e.engineers[t].selected=e.engineers[t].selected?!1:!0)},e.addedSelectE=function(t){e.selectedEngineers[t].selected=e.selectedEngineers[t].selected?!1:!0},e.addE=function(){e.engineers.forEach(t)},e.removeE=function(){for(var t=e.selectedEngineers.length,o=0;t>o;)n(e.selectedEngineers[o])||o++}}]),cascadiaControllers.controller("AEPController",["$scope","$location","Restangular","GrowlResponse",function(e,t,n){n.all("projects").getList().then(function(t){e.projects=t})}]),cascadiaControllers.controller("AEWPController",["$scope","$location","Restangular","$routeParams","GrowlResponse",function(e,t,n,o){e.param=o.id,n.all("work_packages/"+e.param).getList().then(function(t){e.packages=t})}]),cascadiaControllers.controller("ManagerController",["$scope","GrowlResponse",function(e){function t(e){e.selected=!1}e.selectedManager={},e.selectM=function(n){e.managers[n].id;e.managers.forEach(t),e.managers[n].selected=!0,e.selectedManager=e.managers[n]},e.cancel=function(){e.selectedManager={},e.managers.forEach(t)}}]),cascadiaControllers.controller("APController",["$scope","$location","Restangular","GrowlResponse",function(e,t,n){n.one("users",3).get().then(function(t){e.manUser=t}),n.all("projects").getList().then(function(t){e.projects=t})}]),cascadiaControllers.controller("ARController",["$scope","$location","Restangular","$routeParams","GrowlResponse",function(e,t,n,o){e.param=o.id,n.one("work_packages/"+e.param).get().then(function(t){e.package=t}),n.all("users").getList().then(function(t){e.engineers=t})}]),cascadiaControllers.controller("ASController",["$scope","$rootScope","$location","Restangular","GrowlResponse",function(e,t,n,o){e.selectedEngineer,e.selectM=function(t){e.selectedEngineer=t},e.search=function(t){return-1!=t.id.toString().indexOf(e.query)||-1!=t.firstName.indexOf(e.query)||-1!=t.lastName.indexOf(e.query)?!0:!1},e.save=function(){var n=t.userMap[t.user.id];n.supervisorUserID=e.selectedEngineer.id,o.one("users",n.id).customPUT(n)}}]),cascadiaControllers.controller("PackageController",["$scope","GrowlResponse",function(e){function t(t){t.selected===!0&&t.disabled!==!0&&(e.selectedPackages.push({number:t.number,title:t.title,selected:!1}),t.disabled=!0,t.selected=!1)}function n(t){if(void 0!==t&&t.selected===!0){for(var n=t.number,o=0;o<e.packages.length;o++)e.packages[o].number==n&&(e.packages[o].disabled=!1);var r=e.selectedPackages.indexOf(t);return r>-1&&e.selectedPackages.splice(r,1),!0}return!1}e.packages=[{number:"B1111",title:"Project Setup",selected:!1,disabled:!1},{number:"B1112",title:"Ongoing Updating",selected:!1,disabled:!1},{number:"B1113",title:"Detailed Planning",selected:!1,disabled:!1}],e.selectedPackages=[],e.select=function(t){e.packages[t].disabled||(e.packages[t].selected=e.packages[t].selected?!1:!0)},e.addedSelect=function(t){e.selectedPackages[t].selected=e.selectedPackages[t].selected?!1:!0},e.add=function(){e.packages.forEach(t)},e.remove=function(){for(var t=e.selectedPackages.length,o=0;t>o;)n(e.selectedPackages[o])||o++}}]),cascadiaControllers.controller("CreateProjectsController",["$scope","$location","Restangular","GrowlResponse",function(e,t,n,o){var r=n.all("projects");e.rates=[{rate:1.2},{rate:1.6}],e.save=function(){r.post(e.project).then(function(){$.growl.notice("Success","Object Created")},function(e){o(e)})}}]),cascadiaControllers.controller("CreateWPController",["$scope","$location","Restangular","GrowlResponse",function(e,t,n){n.all("projects").getList().then(function(t){e.projects=t}),e.listWP=function(t){n.all("work_packages/project/"+t).getList().then(function(t){e.packages=t})},e.addNew=function(){e.packages.push({workPackageNumber:"",issueDate:"",completeDate:"",startDate:"",description:"",progressStatus:"",endDate:"",estimateToCompletion:"",estimateAtStart:"",projectNumber:""})}}]),cascadiaControllers.controller("DashboardController",["$scope","$rootScope","Restangular","GrowlResponse",function(e,t,n){n.one("user/timesheets").get().then(function(t){e.timesheets=t}),e.date=function(t){var n=e.timesheets[t],o=1+7*(n.weekNumber-1);return new Date(n.year,0,o)},e.delete=function(t,n){user.remove().then(function(){e.timesheets.splice(n,1)}),console.log("timesheet deleted")}}]),cascadiaControllers.controller("EditPayRatesController",["$scope","$location","Restangular","GrowlResponse",function(e,t,n){var o=n.all("pay_rates");e.payRatesMap={},e.payRates=[],o.getList().then(function(t){e.payRates=t;for(var n=0;n<e.payRates.length;++n)e.payRatesMap[e.payRates[n].year]=[];for(var n=0;n<e.payRates.length;++n)e.payRatesMap[e.payRates[n].year].push(e.payRates[n])}),e.index=2014,payRatesChanged=[],e.change=function(e){unique=!0;for(var t=0;t<payRatesChanged.length;t++)if(payRatesChanged[t].id==e.id){unique=!1;break}unique&&payRatesChanged.push(e)},e.edit=function(){for(var e=0;e<payRatesChanged.length;e++)payRatesChanged[e].put()},e.prior=function(){e.payRatesMap[e.index-2]&&e.index--},e.next=function(){e.payRatesMap[e.index+2]&&e.index++},e.current=function(){e.index=2014}}]),cascadiaControllers.controller("EngineerBudgetController",["$scope","$location","Restangular",function(){}]),cascadiaControllers.controller("NavigationController",["$scope","$rootScope","$location","Restangular","GrowlResponse",function(e,t,n,o){o.all("user");e.user=JSON.parse(localStorage.getItem("user")),e.logout=function(){localStorage.clear(),n.path("/login"),$.growl.notice({title:"Success!",message:"You have been logged out."})}}]),cascadiaControllers.controller("LoginController",["$scope","$base64","Restangular","$rootScope","$location","GrowlResponse","permissions",function(e,t,n,o,r,a,s){e.login=function(){var c={username:e.username,password:e.password};n.one("user").post("token",c).then(function(a){e.encodedString=t.encode(a.token+":"),localStorage.setItem("token",e.encodedString),n.setDefaultHeaders({Authorization:"Basic "+e.encodedString}),n.one("user").get().then(function(e){localStorage.setItem("user",JSON.stringify(e)),o.user=e,n.one("user/permissions").get().then(function(e){s.setPermissions(e),localStorage.setItem("permissions",JSON.stringify(e))},function(){var e=[{Name:"ProjectManager"},{Name:"Supervisor"},{Name:"Hr"},{Name:"TimesheetApprover"}];localStorage.setItem("permissions",JSON.stringify(e)),s.setPermissions(e)}),r.path("/dashboard")})},function(e){a(e)})}}]),cascadiaControllers.controller("LogoutController",["$scope","Restangular",function(){}]),cascadiaControllers.controller("ManageApproverController",["$scope","$location","Restangular",function(){}]),cascadiaControllers.controller("ManageProjectController",["$scope","$location","Restangular",function(){}]),cascadiaControllers.controller("WPManagementController",["$scope","Restangular","GrowlResponse",function(e,t){e.statuses=["Open","Closed"],e.project={},mapOfWP={},wpChanged=[],e.listWP=function(n){t.one("work_packages/project").getList(n.projectNumber).then(function(t){e.workPackages=t})},t.one("user/projects/managed").getList().then(function(t){e.projects=t}),e.change=function(e){unique=!0;for(var t=0;t<wpChanged.length;t++)if(wpChanged[t].workPackageNumber==e.workPackageNumber){unique=!1;break}unique&&wpChanged.push(e)},e.edit=function(){for(var e=0;e<wpChanged.length;e++)el=wpChanged[e],t.one("work_packages",el.workPackageNumber).customPUT(el);wpChanged=[]}}]),cascadiaControllers.controller("MonthlyWPController",["$scope","Restangular",function(){}]),cascadiaControllers.controller("PCBACController",["$scope","Restangular",function(){}]),cascadiaControllers.controller("PCPRController",["$scope","Restangular",function(){}]),cascadiaControllers.controller("ProjectManagementController",["$scope","Restangular","GrowlResponse",function(e,t){var n=t.all("projects");t.one("user/projects/managed").getList().then(function(t){e.projects=t}),e.add=function(){e.add_project=!0},e.save=function(){newproject=e.newproject,n.post(newproject).then(function(){e.projects.push(newproject),e.add_project=!1})}}]),cascadiaControllers.controller("ProjectSummaryController",["$scope","Restangular",function(){}]),cascadiaControllers.controller("RateSheetController",["$scope","Restangular","GrowlResponse",function(e,t){t.all("users").getList().then(function(t){e.users=t})}]),cascadiaControllers.controller("SearchProjectController",["$scope","Restangular",function(){}]),cascadiaControllers.controller("TADetailsController",["$scope","$location","Restangular","$routeParams","GrowlResponse",function(e,t,n,o){e.param=o.id,n.one("timesheets",e.param).get().then(function(t){e.timesheet=t})}]),cascadiaControllers.controller("TAController",["$scope","$location","Restangular","GrowlResponse",function(e,t,n){e.timesheets=[],n.all("user/timesheets/to_approve").getList().then(function(t){e.timesheets=t}),e.select=function(n){var o=n,r="/timesheet/",a=r.concat(e.timesheets[o].id);t.path(a)}}]),cascadiaControllers.controller("TimesheetController",["$scope","$rootScope","$location","Restangular","$routeParams","GrowlResponse",function(e,t,n,o,r,a){var s=o.one("user/timesheets");e.workPackageNumbers={},e.projectNumbers=[],s.get({filter:"current"}).then(function(t){currentTimesheet=t,e.timesheet=currentTimesheet},function(e){a(e)}),o.one("user/projects/managed").getList().then(function(t){projects=t;for(var n=0;n<projects.length;++n)e.projectNumbers.push(projects[n].projectNumber)},function(e){a(e)}),e.listWP=function(t){o.one("work_packages/project",t).getList().then(function(n){workPackages=n,e.workPackageNumbers[t]=[];for(var o=0;o<workPackages.length;++o)e.workPackageNumbers[t].push(workPackages[o].workPackageNumber)},function(e){a(e)})},e.prior=function(){year=e.timesheet.year,week=e.timesheet.weekNumber-1,s.get({year:year,week:week}).then(function(t){e.timesheet=t},function(e){a(e)})},e.next=function(){year=e.timesheet.year,week=e.timesheet.weekNumber+1,s.get({year:year,week:week}).then(function(t){e.timesheet=t},function(e){a(e)})},e.save=function(){e.default&&t.user.defaultTimesheetID!=e.timesheet.id&&(t.user.defaultTimesheetID=e.timesheet.id,t.user.put()),e.timesheet.put()},e.delete=function(t){e.timesheet.timesheetRows.splice(t,1)},e.add=function(){e.timesheet.timesheetRows.push({workPackageNumber:"",projectNumber:"",saturday:0,sunday:0,monday:0,tuesday:0,wednesday:0,thursday:0,friday:0,note:""})}}]),cascadiaControllers.controller("UserProfileController",["$scope","$rootScope","$routeParams","Restangular",function(e,t,n){e.param=n.id,e.mUser=t.userMap[e.param]}]),cascadiaControllers.controller("WeeklyProjectController",["$scope","Restangular",function(){}]),cascadiaControllers.controller("WPDetailsController",["$scope","Restangular","$routeParams","GrowlResponse",function(e,t,n){e.param=n.id;var o=t.one("work_packages/"+e.param);o.get().then(function(t){e.package=t}),t.all("work_packages/"+e.param+"/assignments").getList().then(function(t){e.assignments=t})}]),cascadiaControllers.controller("WPStatusReportController",["$scope","Restangular",function(){}]),cascadiaControllers.controller("CreateUserController",["$scope","Restangular","GrowlResponse",function(e,t,n){e.items=["P1","P2","P3","P4","P5"],e.statuses=["Active","Inactive"],e.save=function(){user=e.cUser,t.one("users").customPOST(user).then(function(){$.growl.notice("Success","Object Created")},function(e){n(e)})}}]),cascadiaControllers.controller("UsersManagementController",["$scope","$rootScope","Restangular","GrowlResponse",function(e,t,n,o){var r=n.all("users");e.items=["P1","P2","P3","P4","P5"],e.statuses=["Active","Inactive"],usersChanged=[],r.getList().then(function(t){e.users=t},function(e){GrowlRespone(e)}),e.change=function(e){unique=!0;for(var t=0;t<usersChanged.length;t++)if(usersChanged[t].id==e.id){unique=!1;break}unique&&usersChanged.push(e)},e.delete=function(t,n){t.remove().then(function(){e.users.splice(n,1)}),console.log("user deleted")},e.edit=function(){for(var e=0;e<usersChanged.length;e++)usersChanged[e].put();usersChanged=[]},e.add=function(){e.add_user=!0},e.save=function(){newuser=e.newuser,r.post(newuser).then(function(){e.add_user=!1},function(e){o(e)})}}]);