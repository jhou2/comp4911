var cascadiaControllers=angular.module("cascadiaControllers",["base64","restangular"]);cascadiaControllers.service("CascadiaService",function(e){e.user=JSON.parse(localStorage.getItem("user")),this.initMapOfUsers=function(a){var n=new Worker("js/web-worker.js");n.addEventListener("message",function(a){e.mapOfUsers=JSON.parse(a.data)},!1),n.postMessage(JSON.stringify(a))}}),cascadiaControllers.controller("AEPController",["$scope","CascadiaService","$location","Restangular",function(e,a,n,t){t.all("projects").getList().then(function(a){e.projects=a})}]),cascadiaControllers.controller("AEWPController",["$scope","CascadiaService","$location","Restangular","$routeParams",function(e,a,n,t,r){e.param=r.id,t.all("work_packages/"+e.param).getList().then(function(a){e.packages=a})}]),cascadiaControllers.controller("ARController",["$scope","CascadiaService","$location","Restangular","$routeParams",function(e,a,n,t,r){e.param=r.id,t.one("work_packages/"+e.param).get().then(function(a){e.package=a}),t.all("users").getList().then(function(a){e.engineers=a})}]),cascadiaControllers.controller("APController",["$scope","CascadiaService","$location","Restangular",function(e,a,n,t){t.all("projects").getList().then(function(a){e.projects=a})}]),cascadiaControllers.controller("ASController",["$scope","CascadiaService","$location","Restangular",function(e,a,n,t){t.all("users").getList().then(function(a){e.projects=a})}]),cascadiaControllers.controller("CreateProjectsController",["$scope","CascadiaService","$location","Restangular",function(){}]),cascadiaControllers.controller("WPManagementController",["$scope","CascadiaService","$location","Restangular",function(e,a,n,t){e.statuses=["Open","Closed"],e.project={},mapOfWP={},wpChanged=[],e.listWP=function(a){t.one("work_packages/project").getList(a.projectNumber).then(function(a){e.workPackages=a})},t.one("user/projects/managed").getList().then(function(a){e.projects=a}),e.change=function(e){unique=!0;for(var a=0;a<wpChanged.length;a++)if(wpChanged[a].workPackageNumber==e.workPackageNumber){unique=!1;break}unique&&wpChanged.push(e)},e.edit=function(){for(var e=0;e<wpChanged.length;e++)el=wpChanged[e],t.one("work_packages",el.workPackageNumber).customPUT(el);wpChanged=[]}}]),cascadiaControllers.controller("EditPayRatesController",["$scope","CascadiaService","$location","Restangular",function(e,a,n,t){var r=t.all("pay_rates");r.getList().then(function(a){e.payRates=a}),payRatesChanged=[],e.change=function(e){unique=!0;for(var a=0;a<payRatesChanged.length;a++)if(payRatesChanged[a].id==e.id){unique=!1;break}unique&&payRatesChanged.push(e)},e.edit=function(){for(var e=0;e<payRatesChanged.length;e++)payRatesChanged[e].put()}}]),cascadiaControllers.controller("EngineerBudgetController",["$scope","CascadiaService","$location","Restangular",function(){}]),cascadiaControllers.controller("ManageApproverController",["$scope","CascadiaService","$location","Restangular",function(){}]),cascadiaControllers.controller("ManageProjectController",["$scope","CascadiaService","$location","Restangular",function(){}]),cascadiaControllers.controller("IndexController",["$scope","CascadiaService","$location",function(e,a,n){e.logout=function(){localStorage.clear(),n.path("/login")}}]),cascadiaControllers.controller("TimesheetController",["$scope","CascadiaService","$location","Restangular",function(e,a,n,t){t.all("timesheets").getList().then(function(a){e.timesheets=a})}]),cascadiaControllers.controller("LoginController",["$scope","$base64","Restangular","$rootScope","$location","CascadiaService",function(e,a,n,t,r){e.login=function(){var t={username:e.username,password:e.password};n.one("user").post("token",t).then(function(t){e.encodedString=a.encode(t.token+":"),localStorage.setItem("token",e.encodedString),n.setDefaultHeaders({Authorization:"Basic "+e.encodedString}),n.one("user").get().then(function(e){localStorage.setItem("user",JSON.stringify(e)),r.path("/dashboard")})})}}]),cascadiaControllers.controller("DashboardController",["$scope","$rootScope","Restangular","CascadiaService",function(e,a,n){n.all("user/timesheets").getList().then(function(a){e.timesheets=a}),e.date=function(a){var n=e.timesheets[a],t=1+7*(n.weekNumber-1);return new Date(n.year,0,t)},e.delete=function(a,n){user.remove().then(function(){e.timesheets.splice(n,1)}),console.log("timesheet deleted")}}]),cascadiaControllers.controller("PackageController",["$scope",function(e){function a(a){a.selected===!0&&a.disabled!==!0&&(e.selectedPackages.push({number:a.number,title:a.title,selected:!1}),a.disabled=!0,a.selected=!1)}function n(a){if(void 0!==a&&a.selected===!0){for(var n=a.number,t=0;t<e.packages.length;t++)e.packages[t].number==n&&(e.packages[t].disabled=!1);var r=e.selectedPackages.indexOf(a);return r>-1&&e.selectedPackages.splice(r,1),!0}return!1}e.packages=[{number:"B1111",title:"Project Setup",selected:!1,disabled:!1},{number:"B1112",title:"Ongoing Updating",selected:!1,disabled:!1},{number:"B1113",title:"Detailed Planning",selected:!1,disabled:!1}],e.selectedPackages=[],e.select=function(a){e.packages[a].disabled||(e.packages[a].selected=e.packages[a].selected?!1:!0)},e.addedSelect=function(a){e.selectedPackages[a].selected=e.selectedPackages[a].selected?!1:!0},e.add=function(){e.packages.forEach(a)},e.remove=function(){for(var a=e.selectedPackages.length,t=0;a>t;)n(e.selectedPackages[t])||t++}}]),cascadiaControllers.controller("EngineerController",["$scope",function(e){function a(a){a.selected===!0&&a.disabled!==!0&&(e.selectedEngineers.push({number:a.number,name:a.name,paygrade:a.paygrade,selected:!1}),a.disabled=!0,a.selected=!1)}function n(a){if(void 0!==a&&a.selected===!0){for(var n=a.number,t=0;t<e.engineers.length;t++)e.engineers[t].number==n&&(e.engineers[t].disabled=!1);var r=e.selectedEngineers.indexOf(a);return r>-1&&e.selectedEngineers.splice(r,1),!0}return!1}e.engineers=[{number:"A1111",name:"Javier Olson",paygrade:"P4",selected:!1,disabled:!1},{number:"A1112",name:"Nancy Garcia",paygrade:"P5",selected:!1,disabled:!1},{number:"A1113",name:"David Bowden",paygrade:"SS",selected:!1,disabled:!1}],e.selectedEngineers=[],e.selectE=function(a){e.engineers[a].disabled||(e.engineers[a].selected=e.engineers[a].selected?!1:!0)},e.addedSelectE=function(a){e.selectedEngineers[a].selected=e.selectedEngineers[a].selected?!1:!0},e.addE=function(){e.engineers.forEach(a)},e.removeE=function(){for(var a=e.selectedEngineers.length,t=0;a>t;)n(e.selectedEngineers[t])||t++}}]),cascadiaControllers.controller("ManagerController",["$scope",function(e){function a(e){e.selected=!1}e.managers=[{id:"A1111",name:"Javier Olson",paygrade:"P4",selected:!1},{id:"A1112",name:"Nancy Garcia",paygrade:"P2",selected:!1},{id:"A1113",name:"David Bowden",paygrade:"P5",selected:!1},{id:"A1114",name:"Juan Burdine",paygrade:"SS",selected:!1}],e.selectedManager={},e.selectM=function(n){e.managers[n].id;e.managers.forEach(a),e.managers[n].selected=!0,e.selectedManager=e.managers[n]},e.cancel=function(){e.selectedManager={},e.managers.forEach(a)}}]),cascadiaControllers.controller("ProjectManagementController",["$scope","CascadiaService","Restangular",function(e,a,n){var t=n.all("projects");n.one("user/projects/managed").getList().then(function(a){e.projects=a}),e.add=function(){e.add_project=!0},e.save=function(){newproject=e.newproject,t.post(newproject).then(function(){e.projects.push(newproject),e.add_project=!1})}}]),cascadiaControllers.controller("ProfileController",["$scope","CascadiaService",function(){}]),cascadiaControllers.controller("UsersManagementController",["$scope","$rootScope","Restangular","CascadiaService",function(e,a,n,t){var r=n.all("users");e.items=["P1","P2","P3","P4","P5"],e.statuses=["Active","Inactive"],usersChanged=[],r.getList().then(function(a){e.users=a,t.initMapOfUsers(e.users)}),e.change=function(e){unique=!0;for(var a=0;a<usersChanged.length;a++)if(usersChanged[a].id==e.id){unique=!1;break}unique&&usersChanged.push(e)},e.delete=function(a,n){a.remove().then(function(){e.users.splice(n,1)}),console.log("user deleted")},e.edit=function(){for(var e=0;e<usersChanged.length;e++)usersChanged[e].put();usersChanged=[]},e.add=function(){e.add_user=!0},e.save=function(){newuser=e.newuser,r.post(newuser).then(function(){e.add_user=!1})}}]);