var cascadiaServices=angular.module("cascadiaServices",[]);cascadiaServices.factory("InitUserMap",["Restangular",function(e){return function(r){!r.isAuthenticated||r.userMap&&0!=r.userMap.length||(r.userMap={},e.one("users").getList().then(function(e){r.userList=e;for(var t=0;t<r.userList.length;++t)r.userMap[r.userList[t].id]=r.userList[t]}))}}]),cascadiaServices.factory("AuthenticateUser",["$location","Restangular",function(e,r){return function(t){t.isAuthenticated=localStorage.getItem("token")?!0:!1,t.isAuthenticated?r.setDefaultHeaders({Authorization:"Basic "+localStorage.getItem("token")}):e.path("/login")}}]),cascadiaServices.factory("permissions",function(e){var r;return{setPermissions:function(t){r=t,e.$broadcast("permissionsChanged")},hasPermission:function(e){return e=e.trim(),_.some(r,function(r){return _.isString(r.Name)?r.Name.trim()===e:void 0})}}}),cascadiaServices.factory("GrowlResponse",[function(){return function(e){if(e.status>=200&&e.status<=304)$.growl.notice({title:"Success!"});else if(400==e.status){for(var r=e.errors[0].error,t=1;t<e.errors.length;++t)r+="\n"+e.errors[t].error;$.growl.error({title:"Error! Invalid Values",message:r})}else 401==e.status?$.growl.error({title:"Error!",message:"Unauthorized. Check your username and password."}):403==e.status?$.growl.error({title:"Error!",message:"Forbidden"}):404==e.status?$.growl.error({title:"Error!",message:"Not found. You may be pointing to the wrong endpoint."}):$.growl.error({title:"Error!",message:"Status Code "+e.status})}}]),cascadiaServices.factory("AssignUser",function(){return function(e){e.user=JSON.parse(localStorage.getItem("user"))}});